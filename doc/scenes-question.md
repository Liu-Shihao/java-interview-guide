# 场景问题

## 使用HashMap实现带有过期时间的缓存

## 国际汇款延迟处理
设计一个多币种汇款系统，若中间行处理超时，如何实现自动冲正(Reverse Transaction)?


## 重复支付防止
用户因网络延迟重复提交付款请求，如何通过分布式锁（Redis、Zookeeper）和数据库唯一索引保证幂等性？


## 批量代发工资优化

企业客户上传10万笔工资代发文件，如何用SpringBatch分片处理，并在处理失败时提供部分回滚机制？


## 账户余额并发更新
高并发场景下（如秒杀活动），如何避免账户余额扣减的竞态条件？对比悲观锁和乐观锁的实现


## 分布式事务与一致性

在银行跨行转账场景中，如何保证分布式事务的ACID？

## 分布式书屋一致性
跨系统操作（如转账扣款成功但通知短信发送失败），如何通过Saga模式或者本地消息表保证最终一致性？


## 日终批处理对账
设计一个日终对账系统，比对核心银行系统与第三方支付渠道的交易流水，输出差异报告。如何用多线程加速千万级数据对比？

## 历史账户查询性能
客户查询5年前交易记录时相应缓慢，请设计分表分库（按时间范围）和冷热数据分离方案（如ES归档）



## 服务熔断与降级
当外汇汇率查询服务不可用时，如何通过Hystrix或者Resilience4j返回缓存中的最近有效汇率？避免连锁故障？


## 配置中心热更新
如何通过SpringCloud Config实时更新风控规则阈值，而无需重启服务？说明RefreshScope的原理。

## 订单状态异步通知
使用kafka处理支付结果异步通知商户，如何保证消息至少投递一次（Exactly Once Semantics）？


## 峰值流量削峰
双十一期间支付请求突增10倍，如何通过RabbitMQ延迟队列实现请求排队和平滑处理？



## 死信队列监控
设计一个死信队列（DLQ）告警机制，当支付消息处理失败超过3次时，出发人工干预。


## 信用卡还款日提醒
设计一个定时任务系统，在还款日前3天推送短信、邮件提醒，如何避免重复通知？考虑时区问题


## 虚拟账户体系设计
电商平台资金存管需求，如何设计虚拟子账户体系实现商户资金隔离合和实时余额查询？

## 敏感数据加密
客户姓名、证件号码、手机号等敏感信息在数据库中如何加密？












